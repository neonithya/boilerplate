"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var react_1 = __importDefault(require("react"));
var hoist_non_react_statics_1 = __importDefault(require("hoist-non-react-statics"));
var PropsInjector_1 = __importDefault(require("./PropsInjector"));
var useGraph_1 = __importDefault(require("./useGraph"));
var React_1 = require("../../utils/React");
var ComponentInjector = /** @class */ (function () {
    function ComponentInjector() {
    }
    ComponentInjector.prototype.inject = function (Target, Graph) {
        var Wrapped = this.wrapComponent(Target, Graph);
        (0, hoist_non_react_statics_1.default)(Wrapped, Target);
        return Wrapped;
    };
    ComponentInjector.prototype.wrapComponent = function (InjectionCandidate, Graph) {
        var isMemoized = (0, React_1.isMemoizedComponent)(InjectionCandidate);
        var Target = isMemoized ? InjectionCandidate.type : InjectionCandidate;
        var compare = isMemoized ? InjectionCandidate.compare : undefined;
        return (0, React_1.genericMemo)(function (passedProps) {
            var graph = (0, useGraph_1.default)(Graph, passedProps);
            var proxiedProps = new PropsInjector_1.default(graph).inject(passedProps);
            return react_1.default.createElement(react_1.default.Fragment, null, Target(proxiedProps));
        }, compare);
    };
    return ComponentInjector;
}());
exports.default = ComponentInjector;
//# sourceMappingURL=ComponentInjector.js.map